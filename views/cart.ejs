<%- include('layouts/innerheader'); -%>

<body onload = "dateCheck()">
     
    <div class="flex_div_bread">
    <div class="pdhs">
       <svg class="svgt" _ngcontent-ng-c3832377555="" width="17" height="17" viewBox="0 0 17 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path _ngcontent-ng-c3832377555="" d="M1.42393 16H15.5759C15.6884 16 15.7962 15.9584 15.8758 15.8844C15.9553 15.8104 16 15.71 16 15.6054V6.29143C16 6.22989 15.9846 6.1692 15.9549 6.11422C15.9252 6.05923 15.8821 6.01147 15.829 5.97475L8.75305 1.07803C8.67992 1.02736 8.59118 1 8.5 1C8.40882 1 8.32008 1.02736 8.24695 1.07803L1.17098 5.97587C1.11791 6.01259 1.0748 6.06035 1.04511 6.11534C1.01543 6.17033 0.999976 6.23101 1 6.29255V15.6063C1.00027 15.7108 1.04504 15.8109 1.12451 15.8847C1.20398 15.9585 1.31165 16 1.42393 16ZM10.1464 15.2107H6.85241V10.6202H10.1464V15.2107ZM1.84866 6.48977L8.4999 1.88561L15.1517 6.48977V15.2107H10.9946V10.2256C10.9946 10.1209 10.95 10.0206 10.8704 9.94654C10.7909 9.87254 10.683 9.83096 10.5705 9.83096H6.42848C6.316 9.83096 6.20812 9.87254 6.12858 9.94654C6.04904 10.0206 6.00435 10.1209 6.00435 10.2256V15.2107H1.84806L1.84866 6.48977Z" fill="#55585B" stroke="#55585B" stroke-width="0.5"></path></svg> <span class="hme"><a href="/welcome">Home</a></span><span class="bread_div">/</span><span class="hme">Cart</span>
    </div>
	
</div>
    <% if (errors.length > 0) { %>
      <div class="alert alert-danger alert-dismissible">
          <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
          <%= errors[0] %>
          </div>
      </div>
  <% } %>
  <% if (success.length > 0) { %>
      <div class="alert alert-success alert-dismissible" style="
      margin-top: 35px;
      padding-bottom: -8px;
      width: 83%;
      margin-left: 98px;
  ">
          <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
          <%= success[0] %>
          </div>
      </div>
  <% } %>
      
    <section class="gradient-custom">
        <div class="container py-5 pdt-0">
          <div class="row d-flex justify-content-center my-4">
            <div class="col-md-12">
              <div class="card mb-4">
                <div class="card-header py-3">
                  <h5 class="mb-0">Cart - <%= cartLength %> items</h5>
                </div>
                <div class="card-body cart-data">
                  <!-- Single item -->
                  <% cart[0].cart.forEach(product => { %>

                    <!-- <input type="hidden" name="art_id" id="art_id" value="<%= cart[0].cart[0].art_id %>" />
                    <input type="hidden" name="logged_in" id="logged_in" value="<%= cart[0].cart[0].user_id %>" />
     -->

                  <div class="row">
                    <div class="col-lg-3 col-md-12 mb-4 mb-lg-0">
                      <!-- Image -->
                      <div class="bg-image hover-overlay hover-zoom ripple rounded" data-mdb-ripple-color="light">
                        <img src="<%= product.artData[0].image %>"
                          class="w-100" alt="Blue Jeans Jacket" />
                          <br>
                       
                      </div>

                      <a href="#!">
                        <a class="btn btn-danger" href="remove-cart/<%= product.art_id %>" role="button" style="
                          margin-top: 24px;
                      ">Remove</a>
                      </a>
                      <!-- Image -->
                    </div>
      
                    <div class="col-lg-5 col-md-6 mb-4 mb-lg-0">
                      <!-- Data -->
                      <p style="color: black;"><strong><%= product.artData[0].title %></strong></p>
                      <p style="color: black;"><%= product.artData[0].description %></p>
                      <p style="color: black;">Amount : $<%= product.artData[0].last_bid %></p>
                      
                      <!-- Data -->
                    </div>
      
                    <div class="col-lg-4 col-md-6 mb-4 mb-lg-0">
                      <!-- Quantity -->
                      <div class="d-flex mb-4" style="max-width: 300px">
                       
      
                        <div class="form-outline">
                          <label class="form-label" for="form1">1 Art</label>
                        </div>
      
                        
                      </div>
                      <!-- Quantity -->
      
                      <!-- Price -->
            
                      <!-- Price -->
                    </div>
                  </div>
                  <!-- Single item -->
      
                  <hr class="my-4" />

                  <% }) %>
      
                  <!-- Single item -->
                  
                </div>
              </div>
             
            </div>
            <% if (cartLength > 0) { %>
            <div class="col-md-4">
              <div class="card mb-4">
                <div class="card-header py-3">
                  <h5 class="mb-0">Summary</h5>
                </div>
                <div class="card-body">
                  <ul class="list-group list-group-flush">
                    <li
                      class="list-group-item d-flex justify-content-between align-items-center border-0 px-0 pb-0">
                      Item Cost($)
                      <span id="cost"><%= total %></span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center px-0">
                      Shipping($)
                      <span>10</span>
                    </li>
                    <li class="list-group-item d-flex justify-content-between align-items-center px-0">
                      Tax(10%)($)
                      <span id="percent"></span>
                    </li>
                    <li
                      class="list-group-item d-flex justify-content-between align-items-center border-0 px-0 mb-3">
                      <div>
                        <strong>Total amount($)</strong>
                        
                      </div>
                      <span><strong id="total"><%= total %></strong></span>
                    </li>
                  </ul>
                  <% if (cartLength > 0) { %>
                  <button type="button" class="btn btn-primary btn-lg btn-block" onclick="purchase()">
                    Proceed to checkout
                  </button>
                  <% } %>
                </div>
              </div>
            </div>
            <% } %>

          </div>
        </div>
      </section>

      <script type="text/javascript">
        function dateCheck() {

          var cost = document.getElementById('cost').innerHTML
          var per = document.getElementById('percent').innerHTML

          var percent = (parseFloat(cost)/100) * 10;
          document.getElementById('percent').innerHTML = percent.toFixed(2);

          var total = parseFloat(cost) + 10 + parseFloat(percent);

          document.getElementById('total').innerHTML = total.toFixed(2);

            var ToDate = new Date();
            var UserDate = document.getElementById("userdate").value;
            var logged_in = document.getElementById("logged_in").value;
            var bidder = document.getElementById("bidder").value;

            console.log(bidder , logged_in)


            if (new Date(UserDate).getTime() <= ToDate.getTime()) {
                document.getElementById('bid_amount').style.display = "none"
                document.getElementById('submitBid').style.display = "none"
                document.getElementById('bidend').style.display = "block"
                if(bidder == logged_in){

                document.getElementById('addcart').style.display = "block"
                document.getElementById('buy').style.display = "block"

                }


            }
            
        }

        function success() {
	 if(document.getElementById("bid_amount").value =="") { 
            document.getElementById('submitBid').style.pointerEvents = 'none'; 
        } else { 
            document.getElementById('submitBid').style.pointerEvents = '';
        }
    }

    
function purchase(e) {


// var ToDate = new Date();
//     var form = $(this);
// // var actionUrl = form.attr('action');

// $.ajax({
//     type: "POST",
//     url: 'http://localhost:8081/purchase',
//     data : {
       
//        // will be accessible in $_POST['data1']
//     },
//     success: function(data)
//     {
//       alert('Art Purchased successfully.'); 
      window.location.assign('/checkout');
//     }
// });



}

     </script>
</body>

<%- include('layouts/footer'); -%>